<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<section xmlns="http://docbook.org/ns/docbook" version="5.0" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="_kl__partition_8cpp" xml:lang="en-US">
<title>C:/Users/Nima/Documents/KL/kl_partition.cpp File Reference</title>
<indexterm><primary>C:/Users/Nima/Documents/KL/kl_partition.cpp</primary></indexterm>
<programlisting linenumbering="unnumbered">#include &quot;kl_partition.hpp&quot;<?linebreak?>#include &lt;QFile&gt;<?linebreak?>#include &lt;QMap&gt;<?linebreak?>#include &lt;QTextStream&gt;<?linebreak?>#include &lt;Qstring&gt;<?linebreak?></programlisting><simplesect>
    <title>Functions    </title>
        <itemizedlist>
            <listitem><para>void <link linkend="_kl__partition_8cpp_1ab872a667ec713129635bc000db1ad613">cluster_partition</link> (int p) noexcept</para>

<para>Performs clustering merge for a given partition. </para>
</listitem>
            <listitem><para>double <link linkend="_kl__partition_8cpp_1a37f39f025535112ebaec0dd0ac583afd">cluster_variance</link> (const vector&lt; int &gt; &amp;C) noexcept</para>

<para>Computes variance of a cluster. </para>
</listitem>
            <listitem><para>int <link linkend="_kl__partition_8cpp_1add0f8d8534b753d724adac13fcd8197d">compute_cut</link> () noexcept</para>

<para>Computes the total cut for current partitions. </para>
</listitem>
            <listitem><para>int <link linkend="_kl__partition_8cpp_1aa34c985301df7cde4c1c68d92abb7c35">compute_DV</link> (const vector&lt; int &gt; &amp;C, int p) noexcept</para>

<para>Computes D(V) for a cluster. </para>
</listitem>
            <listitem><para>void <link linkend="_kl__partition_8cpp_1a87bb141a82a3218ac8433cf122cf698e">initial_partition</link> (QString filepath) noexcept</para>

<para>Initializes the partitions from a CSV adjacency matrix file. </para>
</listitem>
            <listitem><para>int <link linkend="_kl__partition_8cpp_1a01d2d5ab4c8d0d4cb049c0cb2c803a99">kl_gain</link> (const vector&lt; int &gt; &amp;A, const vector&lt; int &gt; &amp;B) noexcept</para>

<para>Computes the KL gain of swapping two clusters. </para>
</listitem>
            <listitem><para>void <link linkend="_kl__partition_8cpp_1a49addcfe8c198526df579d1d13a426d6">kl_pass</link> () noexcept</para>

<para>Performs one pass of the Kernighan–Lin algorithm. </para>
</listitem>
            <listitem><para>void <link linkend="_kl__partition_8cpp_1a73773552b90fec6ea5827868d2f0b7b6">write_metrics</link> (const char *filename)</para>

<para>Writes final cut evolution and cluster variances to a file. </para>
</listitem>
            <listitem><para>void <link linkend="_kl__partition_8cpp_1a16e2544f842cc0163cfcebee9a0f6483">write_partition</link> (const char *filename)</para>

<para>Writes node-to-partition mapping to a file. </para>
</listitem>
            <listitem><para>void <link linkend="_kl__partition_8cpp_1a838125c5219dd65df08117068c33787a">write_trace</link> (const char *filename)</para>

<para>Writes cut evolution per iteration to CSV. </para>
</listitem>
        </itemizedlist>
</simplesect>
<section>
<title>Function Documentation</title>
<anchor xml:id="_kl__partition_8cpp_1ab872a667ec713129635bc000db1ad613"/><section>
    <title>cluster_partition()</title>
<indexterm><primary>cluster_partition</primary><secondary>kl_partition.cpp</secondary></indexterm>
<indexterm><primary>kl_partition.cpp</primary><secondary>cluster_partition</secondary></indexterm>
<para><computeroutput>void cluster_partition (int p)<computeroutput>[noexcept]</computeroutput></computeroutput></para><para>

<para>Performs clustering merge for a given partition. </para>
</para>

<para>Performs clustering merge on a given partition.</para>

<para>Iteratively merges clusters if combined variance decreases.</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>p</entry><entry>
<para>Partition index (0 or 1) </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
</section>
<anchor xml:id="_kl__partition_8cpp_1a37f39f025535112ebaec0dd0ac583afd"/><section>
    <title>cluster_variance()</title>
<indexterm><primary>cluster_variance</primary><secondary>kl_partition.cpp</secondary></indexterm>
<indexterm><primary>kl_partition.cpp</primary><secondary>cluster_variance</secondary></indexterm>
<para><computeroutput>double cluster_variance (const vector&lt; int &gt; &amp; C)<computeroutput>[noexcept]</computeroutput></computeroutput></para><para>

<para>Computes variance of a cluster. </para>
</para>

<para>Variance is calculated over all edge weights within the cluster.</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>C</entry><entry>
<para>Cluster of nodes </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Variance value </para>
</formalpara>
</para>
</section>
<anchor xml:id="_kl__partition_8cpp_1add0f8d8534b753d724adac13fcd8197d"/><section>
    <title>compute_cut()</title>
<indexterm><primary>compute_cut</primary><secondary>kl_partition.cpp</secondary></indexterm>
<indexterm><primary>kl_partition.cpp</primary><secondary>compute_cut</secondary></indexterm>
<para><computeroutput>int compute_cut ( )<computeroutput>[noexcept]</computeroutput></computeroutput></para><para>

<para>Computes the total cut for current partitions. </para>
</para>

<para>Computes total cut size for current partition.</para>

<para>Cut is defined as the sum of all edge weights from nodes in partition 0 to nodes in partition 1.</para>

<para><formalpara><title>Returns</title>

<para>Total cut value </para>
</formalpara>
</para>
</section>
<anchor xml:id="_kl__partition_8cpp_1aa34c985301df7cde4c1c68d92abb7c35"/><section>
    <title>compute_DV()</title>
<indexterm><primary>compute_DV</primary><secondary>kl_partition.cpp</secondary></indexterm>
<indexterm><primary>kl_partition.cpp</primary><secondary>compute_DV</secondary></indexterm>
<para><computeroutput>int compute_DV (const vector&lt; int &gt; &amp; C, int p)<computeroutput>[noexcept]</computeroutput></computeroutput></para><para>

<para>Computes D(V) for a cluster. </para>
</para>

<para>D(V) = external_connections - internal_connections</para>

<para>External connections are edges from this cluster to all clusters in the opposite partition. Internal connections are edges from this cluster to other clusters in the same partition.</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>C</entry><entry>
<para>Cluster of nodes </para>
</entry>
                            </row>
                            <row>
<entry>p</entry><entry>
<para>Partition index (0 or 1) </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>Difference between external and internal connections </para>
</formalpara>
</para>
</section>
<anchor xml:id="_kl__partition_8cpp_1a87bb141a82a3218ac8433cf122cf698e"/><section>
    <title>initial_partition()</title>
<indexterm><primary>initial_partition</primary><secondary>kl_partition.cpp</secondary></indexterm>
<indexterm><primary>kl_partition.cpp</primary><secondary>initial_partition</secondary></indexterm>
<para><computeroutput>void initial_partition (QString filepath)<computeroutput>[noexcept]</computeroutput></computeroutput></para><para>

<para>Initializes the partitions from a CSV adjacency matrix file. </para>
</para>

<para>Initializes partitions from an adjacency matrix file.</para>

<para>Reads a CSV file where each row corresponds to a node and contains edge weights to all other nodes. Diagonal elements represent the node itself and are ignored. Initializes a simple even-odd partition: nodes 0,2,4,... go to partition 0, others to partition 1.</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>filepath</entry><entry>
<para>Path to the CSV file containing adjacency matrix </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
</section>
<anchor xml:id="_kl__partition_8cpp_1a01d2d5ab4c8d0d4cb049c0cb2c803a99"/><section>
    <title>kl_gain()</title>
<indexterm><primary>kl_gain</primary><secondary>kl_partition.cpp</secondary></indexterm>
<indexterm><primary>kl_partition.cpp</primary><secondary>kl_gain</secondary></indexterm>
<para><computeroutput>int kl_gain (const vector&lt; int &gt; &amp; A, const vector&lt; int &gt; &amp; B)<computeroutput>[noexcept]</computeroutput></computeroutput></para><para>

<para>Computes the KL gain of swapping two clusters. </para>
</para>

<para>Computes KL gain for swapping two clusters.</para>

<para>Gain = D(A) + D(B) - 2 * edge_sum_between_A_B</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>A</entry><entry>
<para>Cluster from partition 0 </para>
</entry>
                            </row>
                            <row>
<entry>B</entry><entry>
<para>Cluster from partition 1 </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                <formalpara><title>Returns</title>

<para>KL gain value</para>
</formalpara>
Performs one Kernighan–Lin pass</para>

<para>Swaps cluster pairs between partitions to maximize gain. Records the cut evolution in global cut_trace.</para>

<para>Algorithm:<orderedlist>
<listitem>
<para>For each unlocked cluster in partition 0, compute gain with each unlocked cluster in partition 1.</para>
</listitem><listitem>
<para>Select the pair with maximum gain and swap them.</para>
</listitem><listitem>
<para>Lock the swapped clusters.</para>
</listitem><listitem>
<para>Repeat until all clusters are locked or no positive gain.</para>
</listitem><listitem>
<para>Rollback swaps after best prefix sum of gains. </para>
</listitem></orderedlist>
</para>
</section>
<anchor xml:id="_kl__partition_8cpp_1a49addcfe8c198526df579d1d13a426d6"/><section>
    <title>kl_pass()</title>
<indexterm><primary>kl_pass</primary><secondary>kl_partition.cpp</secondary></indexterm>
<indexterm><primary>kl_partition.cpp</primary><secondary>kl_pass</secondary></indexterm>
<para><computeroutput>void kl_pass ( )<computeroutput>[noexcept]</computeroutput></computeroutput></para><para>

<para>Performs one pass of the Kernighan–Lin algorithm. </para>
</para>

<para>Selects cluster pairs to swap to maximize gain. Records cut evolution in cut_trace. </para>
</section>
<anchor xml:id="_kl__partition_8cpp_1a73773552b90fec6ea5827868d2f0b7b6"/><section>
    <title>write_metrics()</title>
<indexterm><primary>write_metrics</primary><secondary>kl_partition.cpp</secondary></indexterm>
<indexterm><primary>kl_partition.cpp</primary><secondary>write_metrics</secondary></indexterm>
<para><computeroutput>void write_metrics (const char * filename)</computeroutput></para><para>

<para>Writes final cut evolution and cluster variances to a file. </para>
</para>

<para>Writes final cut and cluster variances to a file.</para>

<para>Also writes all cut values stored in cut_trace.</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>filename</entry><entry>
<para>Output file path </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
</section>
<anchor xml:id="_kl__partition_8cpp_1a16e2544f842cc0163cfcebee9a0f6483"/><section>
    <title>write_partition()</title>
<indexterm><primary>write_partition</primary><secondary>kl_partition.cpp</secondary></indexterm>
<indexterm><primary>kl_partition.cpp</primary><secondary>write_partition</secondary></indexterm>
<para><computeroutput>void write_partition (const char * filename)</computeroutput></para><para>

<para>Writes node-to-partition mapping to a file. </para>
</para>

<para>Format: node_index partition_index</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>filename</entry><entry>
<para>Output file path </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
</section>
<anchor xml:id="_kl__partition_8cpp_1a838125c5219dd65df08117068c33787a"/><section>
    <title>write_trace()</title>
<indexterm><primary>write_trace</primary><secondary>kl_partition.cpp</secondary></indexterm>
<indexterm><primary>kl_partition.cpp</primary><secondary>write_trace</secondary></indexterm>
<para><computeroutput>void write_trace (const char * filename)</computeroutput></para><para>

<para>Writes cut evolution per iteration to CSV. </para>
</para>

<para>Writes cut evolution per iteration to a CSV file.</para>

<para>Format: step,cut_value</para>

<para>
                <formalpara>
                    <title>
Parameters</title>
                    <para>
                    <table frame="all">
                        <tgroup cols="2" align="left" colsep="1" rowsep="1">
                        <colspec colwidth="1*"/>
                        <colspec colwidth="4*"/>
                        <tbody>
                            <row>
<entry>filename</entry><entry>
<para>Output CSV file path </para>
</entry>
                            </row>
                        </tbody>
                        </tgroup>
                    </table>
                    </para>
                </formalpara>
                </para>
</section>
</section>
</section>
